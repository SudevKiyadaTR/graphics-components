{"version":3,"file":"ReferralBlock.stories-6d411230.js","sources":["../../src/components/ReferralBlock/stories/docs/component.md?raw","../../src/components/ReferralBlock/stores.js","../../src/components/ReferralBlock/ReferralBlock.svelte","../../src/components/ReferralBlock/ReferralBlock.stories.svelte"],"sourcesContent":["export default \"The `ReferralBlock` component creates a set of referral links from recent dotcom stories using the [recent stories by section API](https://www.reuters.com/pf/api/v3/content/fetch/recent-stories-by-sections-v1?query=%7B%22section_ids%22%3A%22%2Fworld%2F%22%2C%22size%22%3A20%2C%22website%22%3A%22reuters%22%7D).\\n\\n> The `section` prop determines which section stories are from.\\n>\\n> You can get the section ID from the section page on dotcom. For example, the section ID for World - Europe stories at `www.reuters.com/world/europe/` would be `/world/europe/`. (The leading and trailing slashes are required!)\\n\\n```html\\n<script>\\n  import { ReferralBlock } from '@reuters-graphics/graphics-components';\\n</script>\\n\\n<ReferralBlock section=\\\"/lifestyle/sports/\\\" />\\n```\\n\"","import { writable } from 'svelte/store';\n\nexport const referrals = writable([]);\n","<!-- @component `ReferralBlock` [Read the docs.](https://reuters-graphics.github.io/graphics-components/?path=/docs/components-ReferralBlock--default) -->\n<script lang=\"ts\">\n  /** ✏️ DOCUMENT your chart's props using TypeScript and JSDoc comments like below! */\n\n  /**\n   * Section ID, which is often the URL path to the section page on reuters.com.\n   *\n   * Note that not all section pages will be available in the recent stories by section API.\n   * @required\n   */\n  export let section: string = '/world/';\n\n  /**\n   * Number of referrals to show.\n   * @required\n   */\n  export let number: number = 4;\n\n  /**\n   * Link [target](https://developer.mozilla.org/en-US/docs/Web/HTML/Element/a#attr-target), e.g., `_blank` or `_parent`.\n   */\n  export let linkTarget: string = '_self';\n\n  /**\n   * Add a heading to the referral block.\n   */\n  export let heading: string = '';\n\n  type ContainerWidth = 'normal' | 'wide' | 'wider' | 'widest' | 'fluid';\n\n  /**\n   * Width of the component within the text well.\n   * @required\n   */\n  export let width: ContainerWidth = 'wide';\n\n  /** Add an ID to target with SCSS. */\n  export let id: string = '';\n\n  /** Add a class to target with SCSS. */\n  export let cls: string = '';\n\n  import Block from '../Block/Block.svelte';\n  import { referrals } from './stores.js';\n\n  import { onMount } from 'svelte';\n  import { getTime } from '../SiteHeader/NavBar/NavDropdown/StoryCard/time';\n\n  let clientWidth;\n\n  onMount(async () => {\n    try {\n      const response = await fetch(\n        'https://www.reuters.com/pf/api/v3/content/fetch/recent-stories-by-sections-v1?' +\n          new URLSearchParams({\n            query: JSON.stringify({\n              section_ids: section,\n              size: 20,\n              website: 'reuters',\n            }),\n          })\n      );\n      const articles = (await response.json()).result.articles\n        .filter((a) => a?.kicker?.name)\n        .filter((a) => a?.thumbnail?.renditions?.landscape?.['240w'])\n        .filter((a) => !a?.content?.third_party)\n        .slice(0, number);\n      referrals.set(articles);\n    } catch (e) {\n      console.warn('Unable to fetch referral links.');\n    }\n  });\n\n  getTime();\n</script>\n\n{#if $referrals.length === number}\n  <Block width=\"{width}\" id=\"{id}\" cls=\"referrals-block {cls}\">\n    {#if heading}\n      <h4 class:stacked=\"{clientWidth && clientWidth < 750}\">{heading}</h4>\n    {/if}\n    <div\n      class=\"referral-container\"\n      class:stacked=\"{clientWidth && clientWidth < 750}\"\n      class:xs=\"{clientWidth && clientWidth < 450}\"\n      bind:clientWidth=\"{clientWidth}\"\n    >\n      {#each $referrals as referral}\n        <div class=\"referral\">\n          <a\n            href=\"https://www.reuters.com{referral.canonical_url}\"\n            target=\"{linkTarget}\"\n            rel=\"{linkTarget === '_blank' ? 'noreferrer' : null}\"\n          >\n            <div class=\"referral-pack\">\n              <div\n                class=\"headline\"\n                class:xs=\"{clientWidth && clientWidth < 450}\"\n              >\n                <div class=\"kicker\" data-chromatic=\"ignore\">\n                  {referral.kicker.name}\n                </div>\n                <div class=\"title\" data-chromatic=\"ignore\">\n                  {referral.title}\n                </div>\n                <div class=\"publish-time\" data-chromatic=\"ignore\">\n                  {getTime(new Date(referral.display_time))}\n                </div>\n              </div>\n              <div\n                class=\"image-container\"\n                class:xs=\"{clientWidth && clientWidth < 450}\"\n              >\n                <img\n                  data-chromatic=\"ignore\"\n                  src=\"{referral.thumbnail.renditions.landscape['240w']}\"\n                  alt=\"{referral.thumbnail.caption ||\n                    referral.thumbnail.alt_text}\"\n                />\n              </div>\n            </div>\n          </a>\n        </div>\n      {/each}\n    </div>\n  </Block>\n{/if}\n\n<style lang=\"scss\">\n  @import '../../scss/fonts/mixins';\n  @import '../../scss/colours/thematic/tr';\n\n  h4 {\n    font-family: var(--theme-font-family-subhed);\n    color: var(--theme-colour-text-primary, #404040);\n    font-size: 1.1rem;\n    margin: 0 0 5px;\n    font-weight: bold;\n    &.stacked {\n      max-width: 450px;\n      margin: 0 auto 5px;\n    }\n  }\n\n  .referral-container {\n    width: 100%;\n    display: inline-flex;\n    flex-wrap: wrap;\n    justify-content: center;\n    gap: 10px 40px;\n    a {\n      text-decoration: none;\n    }\n    &.stacked {\n      .referral {\n        width: 100%;\n        .headline {\n          padding: 0 10px 0 0;\n        }\n      }\n    }\n    .referral {\n      display: block;\n      width: calc(50% - 20px);\n      max-width: 450px;\n\n      &:hover {\n        .title {\n          text-decoration: underline;\n        }\n        img {\n          filter: brightness(85%);\n        }\n      }\n\n      div.referral-pack {\n        display: flex;\n        justify-content: space-around;\n        max-width: 450px;\n        margin: 0 auto;\n      }\n      .headline {\n        display: inline-block;\n        width: calc(100% - 140px);\n        padding: 0 10px 0 0;\n        &.xs {\n          width: calc(100% - 80px);\n          .kicker {\n            font-size: 0.85rem;\n          }\n          .title {\n            font-size: 0.9rem;\n            line-height: 1.1rem;\n          }\n        }\n        .kicker {\n          font-family: var(--theme-font-family-subhed);\n          color: var(--theme-colour-text-secondary, #666666);\n          font-size: 0.9rem;\n          margin: 0;\n          font-weight: 400;\n        }\n        .title {\n          font-family: var(--theme-font-family-subhed);\n          color: var(--theme-colour-text-primary, #404040);\n          font-size: 0.95rem;\n          line-height: 1.15rem;\n          font-weight: bold;\n          margin: 0;\n        }\n        .publish-time {\n          font-family: var(--theme-font-family-subhed);\n          color: var(--theme-colour-text-secondary, #666666);\n          font-size: 0.75rem;\n          margin: 2px 0 0;\n          font-weight: 400;\n        }\n      }\n      .image-container {\n        margin: 0;\n        overflow: hidden;\n        border-radius: 10px;\n        border: 1px solid var(--theme-colour-brand-rules, #d0d0d0);\n        display: block;\n        position: relative;\n        width: 140px;\n        height: 90px;\n        &.xs {\n          width: 80px;\n          height: 60px;\n        }\n        img {\n          transition: filter 0.1s;\n          display: block;\n          width: 100%;\n          height: inherit;\n          object-fit: cover;\n          margin: 0;\n        }\n      }\n    }\n  }\n</style>\n","<script>\n  import { Meta, Template, Story } from '@storybook/addon-svelte-csf';\n\n  // @ts-ignore\n  import componentDocs from './stories/docs/component.md?raw';\n\n  import ReferralBlock from './ReferralBlock.svelte';\n\n  import { withComponentDocs } from '$docs/utils/withParams.js';\n\n  const metaProps = {\n    ...withComponentDocs(componentDocs),\n    argTypes: {\n      width: {\n        control: 'select',\n        options: ['normal', 'wide', 'wider', 'widest', 'fluid'],\n      },\n      section: {\n        control: 'select',\n        options: [\n          '/world/',\n          '/world/europe/',\n          '/lifestyle/',\n          '/lifestyle/sports/',\n          '/legal/',\n          '/business/',\n          '/business/energy/',\n        ],\n      },\n      number: {\n        control: 'select',\n        options: [2, 4, 6, 8],\n      },\n    },\n  };\n</script>\n\n<Meta\n  title=\"Components/ReferralBlock\"\n  component=\"{ReferralBlock}\"\n  {...metaProps}\n/>\n\n<Template let:args>\n  <ReferralBlock {...args} />\n</Template>\n\n<Story\n  name=\"Default\"\n  args=\"{{\n    section: '/lifestyle/sports/',\n    number: 4,\n    cls: 'my-3',\n  }}\"\n/>\n"],"names":["componentDocs","referrals","writable","ctx","insert","target","h4","anchor","t2_value","t4_value","getTime","src_url_equal","img","img_src_value","attr","a","a_href_value","a_rel_value","div6","append","div5","div3","div0","div1","div2","div4","set_data","t0","t0_value","dirty","t2","t4","create_if_block_1","i","div","create_if_block","section","$$props","number","linkTarget","heading","width","id","cls","clientWidth","onMount","articles","_a","_c","_b","ReferralBlock","withComponentDocs"],"mappings":"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"}